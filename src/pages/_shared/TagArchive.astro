---
import Layout from '~/layouts/Layout.astro'
import PostPreview from '~/components/PostPreview.astro'
import Pagination from '~/components/Pagination.astro'
import PageHeader from '~/components/PageHeader.astro'
import { defaultLang, useTranslations, type Lang } from '~/i18n/config'

interface Props {
  lang?: Lang
  page: {
    data: any[]
    currentPage: number
    url: {
      prev?: string | null
      next?: string | null
    }
  }
  tagTitle: string
}

const { lang = defaultLang, page, tagTitle } = Astro.props as Props
const t = useTranslations(lang)
const titlePrefix = t('tags.titlePrefix')
const pageTitle =
  page.currentPage > 1
    ? t('tags.titleWithPage', { tag: tagTitle, page: page.currentPage })
    : `${titlePrefix}: ${tagTitle}`
const description = t('tags.description', { tag: tagTitle })
---

<Layout lang={lang} title={pageTitle} description={description}>
  <div class="mt-2 sm:mt-0">
    <PageHeader lang={lang} titlePieces={[t('tags.breadcrumb'), tagTitle]} />
    {page.data.map((post) => (
      <PostPreview post={post} lang={lang} />
    ))}
    <Pagination
      prevLink={page.url.prev ? encodeURI(page.url.prev) : undefined}
      prevText={t('pagination.newerPosts')}
      prevAriaLabel={t('paginationAria.previous')}
      nextLink={page.url.next ? encodeURI(page.url.next) : undefined}
      nextText={t('pagination.olderPosts')}
      nextAriaLabel={t('paginationAria.next')}
    />
  </div>
</Layout>
