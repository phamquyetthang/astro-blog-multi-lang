---
import { getLanguageOptions, useTranslations, type Lang } from '~/i18n/config'

interface Props {
  lang: Lang
}

const { lang } = Astro.props
const t = useTranslations(lang)
const options = getLanguageOptions(Astro.url)
const selectId = `language-switcher-${Math.random().toString(36).slice(2, 8)}`
---

<div class="block">
  <label class="sr-only" for={selectId}>{t('language.switcherAria')}</label>
  <select
    id={selectId}
    class="hidden sm:block border-2 border-accent/40 rounded-xl bg-background px-2.5 py-1 text-sm cursor-pointer capitalize"
    onchange="window.location.href=this.value"
  >
    {options.map((option) => (
      <option value={option.href} selected={option.lang === lang} class="capitalize">
        {option.label}
      </option>
    ))}
  </select>
  <select
    id={selectId}
    class="block sm:hidden border-2 border-accent/40 rounded-xl bg-background px-2.5 py-1 text-sm cursor-pointer capitalize"
    onchange="window.location.href=this.value"
  >
    {options.map((option) => (
      <option value={option.href} selected={option.lang === lang} class="capitalize">
        {option.lang}
      </option>
    ))}
  </select>
</div>
